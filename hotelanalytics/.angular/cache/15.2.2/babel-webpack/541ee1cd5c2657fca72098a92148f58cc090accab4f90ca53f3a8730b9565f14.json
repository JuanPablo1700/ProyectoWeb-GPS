{"ast":null,"code":"import _asyncToGenerator from \"/Users/arlethe/Documents/Escuela/GPS/ProyectoWeb-GPS/hotelanalytics/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { __decorate } from \"tslib\";\nimport { Component } from '@angular/core';\nlet LoginComponent = class LoginComponent {\n  constructor(_userService, toastr, router, _errorService) {\n    this._userService = _userService;\n    this.toastr = toastr;\n    this.router = router;\n    this._errorService = _errorService;\n    this.user = '';\n    this.password = '';\n  }\n  ngOnInit() {}\n  login() {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      if (_this.user == '' || _this.password == '') {\n        _this.toastr.error('Todos los campos son obligatorios', 'Error');\n        return;\n      }\n      const user = {\n        user: _this.user,\n        password: _this.password\n      };\n      yield _this._userService.login(user).subscribe({\n        next: json => {\n          const data = json.split(\"-separador-\");\n          console.log(data);\n          const token = data[0];\n          const activo = data[1];\n          const tipo_usuario = data[2];\n          const pass_actualizada = data[3];\n          if (activo === \"1\") {\n            localStorage.setItem('token', token);\n            localStorage.setItem('user', user.user);\n            localStorage.setItem('tipo_usuario', tipo_usuario);\n            if (pass_actualizada === \"0\") {\n              _this.router.navigate(['/inicio']);\n            } else {\n              if (tipo_usuario === \"admin\") {\n                _this.router.navigate(['/principaldirector']);\n              } else if (tipo_usuario === \"gerente\") {\n                _this.router.navigate(['/principalgerente']);\n              } else if (tipo_usuario === \"recepcionista\") {\n                _this.router.navigate(['/principalrecepcionista']);\n              }\n            }\n          } else {\n            _this.toastr.error(\"Usuario desactivado\", \"Error\");\n            _this.router.navigate(['/login']);\n          }\n        },\n        error: e => {\n          _this._errorService.msjError(e);\n        },\n        complete: () => console.log('complete')\n      });\n    })();\n  }\n};\nLoginComponent = __decorate([Component({\n  selector: 'app-login',\n  templateUrl: './login.component.html',\n  styleUrls: ['./login.component.css']\n})], LoginComponent);\nexport { LoginComponent };","map":{"version":3,"mappings":";;AACA,SAASA,SAAS,QAAgB,eAAe;AAY1C,IAAMC,cAAc,GAApB,MAAMA,cAAc;EAIvBC,YACYC,YAAyB,EACzBC,MAAqB,EACrBC,MAAc,EACdC,aAA2B;IAH3B,iBAAY,GAAZH,YAAY;IACZ,WAAM,GAANC,MAAM;IACN,WAAM,GAANC,MAAM;IACN,kBAAa,GAAbC,aAAa;IAPzB,SAAI,GAAW,EAAE;IACjB,aAAQ,GAAW,EAAE;EAOjB;EAEJC,QAAQ,IAER;EAEMC,KAAK;IAAA;IAAA;MACP,IAAI,KAAI,CAACC,IAAI,IAAI,EAAE,IAAI,KAAI,CAACC,QAAQ,IAAI,EAAE,EAAE;QACxC,KAAI,CAACN,MAAM,CAACO,KAAK,CAAC,mCAAmC,EAAE,OAAO,CAAC;QAC/D;;MAGJ,MAAMF,IAAI,GAAS;QACfA,IAAI,EAAE,KAAI,CAACA,IAAI;QACfC,QAAQ,EAAE,KAAI,CAACA;OAClB;MAED,MAAM,KAAI,CAACP,YAAY,CAACK,KAAK,CAACC,IAAI,CAAC,CAACG,SAAS,CAAC;QAC1CC,IAAI,EAAGC,IAAI,IAAI;UACX,MAAMC,IAAI,GAAGD,IAAI,CAACE,KAAK,CAAC,aAAa,CAAC;UACtCC,OAAO,CAACC,GAAG,CAACH,IAAI,CAAC;UAEjB,MAAMI,KAAK,GAAGJ,IAAI,CAAC,CAAC,CAAC;UACrB,MAAMK,MAAM,GAAGL,IAAI,CAAC,CAAC,CAAC;UACtB,MAAMM,YAAY,GAAGN,IAAI,CAAC,CAAC,CAAC;UAC5B,MAAMO,gBAAgB,GAAGP,IAAI,CAAC,CAAC,CAAC;UAEhC,IAAIK,MAAM,KAAK,GAAG,EAAE;YAChBG,YAAY,CAACC,OAAO,CAAC,OAAO,EAAEL,KAAK,CAAC;YACpCI,YAAY,CAACC,OAAO,CAAC,MAAM,EAAEf,IAAI,CAACA,IAAI,CAAC;YACvCc,YAAY,CAACC,OAAO,CAAC,cAAc,EAAEH,YAAY,CAAC;YAClD,IAAIC,gBAAgB,KAAK,GAAG,EAAE;cAC1B,KAAI,CAACjB,MAAM,CAACoB,QAAQ,CAAC,CAAC,SAAS,CAAC,CAAC;aACpC,MAAM;cACH,IAAIJ,YAAY,KAAK,OAAO,EAAE;gBAC1B,KAAI,CAAChB,MAAM,CAACoB,QAAQ,CAAC,CAAC,oBAAoB,CAAC,CAAC;eAC/C,MAAM,IAAIJ,YAAY,KAAK,SAAS,EAAE;gBACnC,KAAI,CAAChB,MAAM,CAACoB,QAAQ,CAAC,CAAC,mBAAmB,CAAC,CAAC;eAC9C,MAAM,IAAIJ,YAAY,KAAK,eAAe,EAAE;gBACzC,KAAI,CAAChB,MAAM,CAACoB,QAAQ,CAAC,CAAC,yBAAyB,CAAC,CAAC;;;WAG5D,MAAM;YACH,KAAI,CAACrB,MAAM,CAACO,KAAK,CAAC,qBAAqB,EAAE,OAAO,CAAC;YACjD,KAAI,CAACN,MAAM,CAACoB,QAAQ,CAAC,CAAC,QAAQ,CAAC,CAAC;;QAExC,CAAC;QACDd,KAAK,EAAGe,CAAoB,IAAI;UAC5B,KAAI,CAACpB,aAAa,CAACqB,QAAQ,CAACD,CAAC,CAAC;QAClC,CAAC;QACDE,QAAQ,EAAE,MAAMX,OAAO,CAACC,GAAG,CAAC,UAAU;OACzC,CAAC;IAAA;EACN;CACH;AA9DYjB,cAAc,eAL1BD,SAAS,CAAC;EACP6B,QAAQ,EAAE,WAAW;EACrBC,WAAW,EAAE,wBAAwB;EACrCC,SAAS,EAAE,CAAC,uBAAuB;CACtC,CAAC,GACW9B,cAAc,CA8D1B;SA9DYA,cAAc","names":["Component","LoginComponent","constructor","_userService","toastr","router","_errorService","ngOnInit","login","user","password","error","subscribe","next","json","data","split","console","log","token","activo","tipo_usuario","pass_actualizada","localStorage","setItem","navigate","e","msjError","complete","selector","templateUrl","styleUrls"],"sourceRoot":"","sources":["/Users/arlethe/Documents/Escuela/GPS/ProyectoWeb-GPS/hotelanalytics/src/app/components/login/login.component.ts"],"sourcesContent":["import { HttpErrorResponse } from '@angular/common/http';\nimport { Component, OnInit } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { ToastrService } from 'ngx-toastr';\nimport { User } from 'src/app/interfaces/user';\nimport { ErrorService } from 'src/app/services/error.service';\nimport { UserService } from 'src/app/services/user.service';\n\n@Component({\n    selector: 'app-login',\n    templateUrl: './login.component.html',\n    styleUrls: ['./login.component.css']\n})\nexport class LoginComponent implements OnInit {\n    user: string = '';\n    password: string = '';\n\n    constructor(\n        private _userService: UserService,\n        private toastr: ToastrService,\n        private router: Router,\n        private _errorService: ErrorService\n    ) { }\n\n    ngOnInit(): void {\n\n    }\n\n    async login() {\n        if (this.user == '' || this.password == '') {\n            this.toastr.error('Todos los campos son obligatorios', 'Error');\n            return\n        }\n\n        const user: User = {\n            user: this.user,\n            password: this.password\n        }\n\n        await this._userService.login(user).subscribe({\n            next: (json) => {\n                const data = json.split(\"-separador-\");\n                console.log(data);\n                \n                const token = data[0];\n                const activo = data[1];\n                const tipo_usuario = data[2];\n                const pass_actualizada = data[3];\n\n                if (activo === \"1\") {\n                    localStorage.setItem('token', token);\n                    localStorage.setItem('user', user.user);\n                    localStorage.setItem('tipo_usuario', tipo_usuario);\n                    if (pass_actualizada === \"0\") {\n                        this.router.navigate(['/inicio']);\n                    } else {\n                        if (tipo_usuario === \"admin\") {\n                            this.router.navigate(['/principaldirector']);\n                        } else if (tipo_usuario === \"gerente\") {\n                            this.router.navigate(['/principalgerente']);\n                        } else if (tipo_usuario === \"recepcionista\") {\n                            this.router.navigate(['/principalrecepcionista']);\n                        }\n                    }\n                } else {\n                    this.toastr.error(\"Usuario desactivado\", \"Error\");\n                    this.router.navigate(['/login']);\n                }\n            },\n            error: (e: HttpErrorResponse) => {\n                this._errorService.msjError(e);\n            },\n            complete: () => console.log('complete')\n        })\n    }\n}\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}